!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";class e{constructor(e="https://comment-widget-backend.vercel.app"){this.baseUrl=e,this.defaultHeaders={"Content-Type":"application/json"}}async request(e,t={}){const n=`${this.baseUrl}${e}`,r={headers:{...this.defaultHeaders,...t.headers},...t};try{const e=await fetch(n,r);if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.detail||`HTTP ${e.status}: ${e.statusText}`)}return await e.json()}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw new Error("Network error: Unable to connect to API");throw e}}async getComments(e,t={}){const n=new URLSearchParams({thread_id:e,...t});return this.request(`/widget/comments/${e}?${n}`)}async createComment(e){return this.request("/comments",{method:"POST",body:JSON.stringify(e)})}async updateComment(e,t){return this.request(`/comments/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteComment(e){return this.request(`/comments/${e}`,{method:"DELETE"})}async moderateComment(e,t){return this.request(`/comments/${e}/moderate`,{method:"PUT",body:JSON.stringify(t)})}async getThread(e){return this.request(`/threads/${e}`)}async createThread(e){return this.request("/threads",{method:"POST",body:JSON.stringify(e)})}async getDemoThread(){return this.request("/demo/thread")}async healthCheck(){return this.request("/health")}}class t{constructor(){this.templates={widget:e=>`\n                <div class="comment-widget" data-theme="${e.theme}">\n                    <div class="comment-header">\n                        <h3>üí¨ Comments</h3>\n                        ${e.showThemeSelector?this.renderThemeSelector(e.theme,e.onThemeChange):""}\n                    </div>\n\n                    ${e.error?this.renderError(e.error):""}\n\n                    ${e.loading?this.renderLoading():""}\n\n                    ${e.loading||e.error?"":this.renderCommentForm(e.onSubmit)}\n\n                    <div class="comment-list">\n                        ${e.comments.length>0?e.comments.map(t=>this.renderComment(t,0,e.maxDepth)).join(""):this.renderEmptyState()}\n                    </div>\n                </div>\n            `,comment:(e,t,n)=>`\n                <div class="comment-item level-${t}" data-id="${e.id}">\n                    <div class="comment-avatar">\n                        <div class="avatar-placeholder">\n                            ${e.author_name.charAt(0).toUpperCase()}\n                        </div>\n                    </div>\n                    <div class="comment-content">\n                        <div class="comment-meta">\n                            <span class="comment-author">${this.escapeHtml(e.author_name)}</span>\n                            <span class="comment-date">${this.formatDate(e.created_at)}</span>\n                        </div>\n                        <div class="comment-text">${this.formatContent(e.content)}</div>\n                        <div class="comment-actions">\n                            ${t<n?`<button class="reply-btn" data-parent-id="${e.id}">Reply</button>`:""}\n                        </div>\n                        ${e.replies&&e.replies.length>0?`<div class="comment-replies">${e.replies.map(e=>this.renderComment(e,t+1,n)).join("")}</div>`:""}\n                    </div>\n                </div>\n            `,form:e=>'\n                <form class="comment-form" id="comment-form">\n                    <div class="form-group">\n                        <input type="text" id="author-name" placeholder="Your name" required>\n                    </div>\n                    <div class="form-group">\n                        <input type="email" id="author-email" placeholder="Your email" required>\n                    </div>\n                    <div class="form-group">\n                        <textarea id="comment-content" placeholder="Write your comment..." required rows="4"></textarea>\n                    </div>\n                    <div class="form-actions">\n                        <button type="submit" class="submit-btn">Post Comment</button>\n                    </div>\n                </form>\n            ',themeSelector:(e,t)=>`\n                <select class="theme-selector" id="theme-selector">\n                    <option value="default" ${"default"===e?"selected":""}>Default</option>\n                    <option value="dark" ${"dark"===e?"selected":""}>Dark</option>\n                    <option value="matrix" ${"matrix"===e?"selected":""}>Matrix</option>\n                    <option value="neocities" ${"neocities"===e?"selected":""}>NeoCities</option>\n                    <option value="serene-mist" ${"serene-mist"===e?"selected":""}>Serene Mist</option>\n                    <option value="neon-pulse" ${"neon-pulse"===e?"selected":""}>Neon Pulse</option>\n                    <option value="geometric-prime" ${"geometric-prime"===e?"selected":""}>Geometric Prime</option>\n                    <option value="forest-flow" ${"forest-flow"===e?"selected":""}>Forest Flow</option>\n                    <option value="digital-chaos" ${"digital-chaos"===e?"selected":""}>Digital Chaos</option>\n                </select>\n            `,loading:()=>'\n                <div class="loading-state">\n                    <div class="spinner"></div>\n                    <p>Loading comments...</p>\n                </div>\n            ',error:e=>`\n                <div class="error-state">\n                    <p>‚ùå ${this.escapeHtml(e)}</p>\n                </div>\n            `,empty:()=>'\n                <div class="empty-state">\n                    <p>üí≠ No comments yet. Be the first to comment!</p>\n                </div>\n            '}}render(e){return this.templates.widget(e)}renderComment(e,t,n){return this.templates.comment(e,t,n)}renderCommentForm(e){return this.templates.form(e)}renderThemeSelector(e,t){return this.templates.themeSelector(e,t)}renderLoading(){return this.templates.loading()}renderError(e){return this.templates.error(e)}renderEmptyState(){return this.templates.empty()}formatDate(e){if(!e)return"";const t=new Date(e),n=new Date,r=Math.floor((n-t)/36e5);return r<1?"Just now":r<24?`${r}h ago`:t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}formatContent(e){return this.escapeHtml(e).replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>")}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}}class n{constructor(e="default"){this.currentTheme=e,this.themes={default:this.getDefaultTheme(),dark:this.getDarkTheme(),matrix:this.getMatrixTheme(),neocities:this.getNeocitiesTheme(),"serene-mist":this.getSereneMistTheme(),"neon-pulse":this.getNeonPulseTheme(),"geometric-prime":this.getGeometricPrimeTheme(),"forest-flow":this.getForestFlowTheme(),"digital-chaos":this.getDigitalChaosTheme()},this.themeCSS=new Map,this.transitionDuration=300,this.init()}init(){document.addEventListener("themeChange",e=>{this.syncWithDashboard(e.detail.theme)}),this.loadThemeCSS()}setTheme(e,t=!0){this.themes[e]||(console.warn(`Theme "${e}" not found, falling back to default`),e="default");const n=this.currentTheme;this.currentTheme=e,this.applyTheme(t),this.dispatchThemeChange(n,e)}syncWithDashboard(e){const t={default:"default",dark:"dark",matrix:"matrix",neocities:"neocities"}[e]||"default";t!==this.currentTheme&&this.setTheme(t,!0)}applyTheme(e=!0){const t=this.themes[this.currentTheme]||this.themes.default;this.applyCSSVariables(t,e),this.applyThemeEffects(t),this.updateMetaThemeColor(t.colors.primary)}applyCSSVariables(e,t=!0){const n=document.documentElement;t?(n.style.setProperty("--widget-transition-duration",e.transitions.duration),n.style.setProperty("--widget-transition-easing",e.transitions.easing)):n.style.setProperty("--widget-transition-duration","0s"),Object.entries(e.colors).forEach(([e,t])=>{n.style.setProperty(`--widget-${e}`,t)}),Object.entries(e.fonts).forEach(([e,t])=>{n.style.setProperty(`--widget-font-${e}`,t)}),Object.entries(e.spacing).forEach(([e,t])=>{n.style.setProperty(`--widget-spacing-${e}`,t)}),n.style.setProperty("--widget-border-radius",e.borderRadius)}applyThemeEffects(e){const t=document.querySelector("comment-widget");if(t&&t.shadowRoot){const e=t.shadowRoot.querySelector("#indie-comments-app");e&&(e.className=e.className.replace(/theme-\w+/g,""),e.classList.add(`theme-${this.currentTheme}`))}switch(this.currentTheme){case"matrix":this.applyMatrixEffects();break;case"neocities":this.applyNeocitiesEffects();break;case"dark":this.applyDarkEffects();break;case"serene-mist":this.applySereneMistEffects();break;case"neon-pulse":this.applyNeonPulseEffects();break;case"geometric-prime":this.applyGeometricPrimeEffects();break;case"forest-flow":this.applyForestFlowEffects();break;case"digital-chaos":this.applyDigitalChaosEffects();break;default:this.applyDefaultEffects()}}applyMatrixEffects(){console.log("Matrix theme effects applied")}applyNeocitiesEffects(){console.log("NeoCities theme effects applied")}applyDarkEffects(){console.log("Dark theme effects applied")}applyDefaultEffects(){console.log("Default theme effects applied")}applySereneMistEffects(){this.widgetElement.style.animation="serene-breath 4s ease-in-out infinite"}applyNeonPulseEffects(){this.widgetElement.style.animation="neon-pulse 2s ease-in-out infinite"}applyGeometricPrimeEffects(){this.widgetElement.style.animation="geometric-rotate 8s linear infinite"}applyForestFlowEffects(){this.widgetElement.style.animation="forest-wave 6s ease-in-out infinite"}applyDigitalChaosEffects(){this.widgetElement.style.animation="digital-glitch 0.3s ease-in-out infinite, scan-line 2s linear infinite"}updateMetaThemeColor(e){let t=document.querySelector('meta[name="theme-color"]');t||(t=document.createElement("meta"),t.name="theme-color",document.head.appendChild(t)),t.content=e}dispatchThemeChange(e,t){document.dispatchEvent(new CustomEvent("commentWidgetThemeChange",{detail:{theme:t,previousTheme:e,config:this.themes[t]}}))}async loadThemeCSS(){const e={dark:"/frontend/static/css/themes/dark.css",matrix:"/frontend/static/css/themes/matrix.css",neocities:"/frontend/static/css/themes/neocities.css"};for(const[t,n]of Object.entries(e))try{const e=await fetch(n);if(e.ok){const n=await e.text();this.themeCSS.set(t,n)}}catch(e){console.warn(`Failed to load theme CSS for ${t}:`,e)}}getThemeCSS(e){return this.themeCSS.get(e)||""}getDefaultTheme(){return"\n            /* Default theme with CSS variables */\n            .comment-widget {\n                font-family: var(--widget-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif);\n                max-width: 680px;\n                margin: 2rem auto;\n                padding: 1.5rem;\n                background: var(--widget-background, #fff);\n                border: 1px solid var(--widget-border, #e0e0e0);\n                border-radius: var(--widget-border-radius, 8px);\n                box-shadow: 0 2px 10px var(--widget-shadow, rgba(0,0,0,0.1));\n                color: var(--widget-text, #333);\n                transition: var(--widget-transition, all 0.3s ease);\n            }\n\n            .comment-header {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                margin-bottom: 1.5rem;\n                padding-bottom: 1rem;\n                border-bottom: 1px solid var(--widget-border, #e0e0e0);\n            }\n\n            .comment-header h3 {\n                margin: 0;\n                color: var(--widget-text, #333);\n                font-size: 1.5rem;\n                font-weight: 600;\n            }\n\n            .theme-selector {\n                padding: 0.5rem;\n                border: 1px solid var(--widget-border, #ddd);\n                border-radius: var(--widget-border-radius, 4px);\n                background: var(--widget-surface, #fff);\n                color: var(--widget-text, #333);\n                font-size: 0.9rem;\n            }\n\n            .comment-form {\n                background: var(--widget-surface, #f8f9fa);\n                padding: 1.5rem;\n                border-radius: var(--widget-border-radius, 6px);\n                margin-bottom: 2rem;\n                border: 1px solid var(--widget-border, #e9ecef);\n            }\n\n            .form-group {\n                margin-bottom: 1rem;\n            }\n\n            .form-group input,\n            .form-group textarea {\n                width: 100%;\n                padding: 0.75rem;\n                border: 1px solid var(--widget-border, #ddd);\n                border-radius: var(--widget-border-radius, 4px);\n                font-size: 1rem;\n                box-sizing: border-box;\n                font-family: inherit;\n                background: var(--widget-surface, #fff);\n                color: var(--widget-text, #333);\n                transition: var(--widget-transition, border-color 0.2s);\n            }\n\n            .form-group input:focus,\n            .form-group textarea:focus {\n                border-color: var(--widget-primary, #007cba);\n                box-shadow: 0 0 0 0.2rem rgba(0, 124, 186, 0.25);\n            }\n\n            .form-group textarea {\n                min-height: 100px;\n                resize: vertical;\n            }\n\n            .form-actions {\n                text-align: right;\n            }\n\n            .submit-btn {\n                background: var(--widget-primary, #007cba);\n                color: white;\n                border: none;\n                padding: 0.75rem 1.5rem;\n                border-radius: var(--widget-border-radius, 4px);\n                font-size: 1rem;\n                cursor: pointer;\n                transition: var(--widget-transition, background 0.2s);\n            }\n\n            .submit-btn:hover {\n                background: var(--widget-primary, #007cba);\n                opacity: 0.9;\n                transform: translateY(-1px);\n            }\n\n            .comment-list {\n                margin-top: 1.5rem;\n            }\n\n            .comment-item {\n                display: flex;\n                padding: 1rem;\n                margin-bottom: 1rem;\n                background: var(--widget-surface, #fff);\n                border: 1px solid var(--widget-border, #eee);\n                border-radius: var(--widget-border-radius, 6px);\n                border-left: 3px solid var(--widget-primary, #007cba);\n                transition: var(--widget-transition, all 0.2s);\n            }\n\n            .comment-item:hover {\n                transform: translateY(-1px);\n                box-shadow: 0 4px 12px var(--widget-shadow, rgba(0,0,0,0.1));\n            }\n\n            .comment-item.level-1 {\n                margin-left: 2rem;\n                border-left-width: 2px;\n                border-left-color: var(--widget-secondary, #888);\n            }\n\n            .comment-item.level-2 {\n                margin-left: 3rem;\n                border-left-width: 1px;\n                border-left-color: var(--widget-border, #ccc);\n            }\n\n            .comment-avatar {\n                margin-right: 1rem;\n                flex-shrink: 0;\n            }\n\n            .avatar-placeholder {\n                width: 40px;\n                height: 40px;\n                border-radius: 50%;\n                background: var(--widget-primary, #007cba);\n                color: white;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                font-weight: bold;\n                font-size: 1.1rem;\n            }\n\n            .comment-content {\n                flex: 1;\n            }\n\n            .comment-meta {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                margin-bottom: 0.5rem;\n                font-size: 0.9rem;\n            }\n\n            .comment-author {\n                font-weight: 600;\n                color: var(--widget-primary, #007cba);\n            }\n\n            .comment-date {\n                color: var(--widget-text-muted, #888);\n            }\n\n            .comment-text {\n                line-height: 1.6;\n                color: var(--widget-text, #444);\n                margin-bottom: 0.5rem;\n            }\n\n            .comment-actions {\n                font-size: 0.8rem;\n            }\n\n            .reply-btn {\n                background: none;\n                border: none;\n                color: var(--widget-primary, #007cba);\n                cursor: pointer;\n                text-decoration: underline;\n                font-size: 0.8rem;\n                transition: var(--widget-transition, color 0.2s);\n            }\n\n            .reply-btn:hover {\n                color: var(--widget-primary, #007cba);\n                opacity: 0.8;\n            }\n\n            .comment-replies {\n                margin-top: 1rem;\n                margin-left: 1rem;\n            }\n\n            .loading-state,\n            .error-state,\n            .empty-state {\n                text-align: center;\n                padding: 2rem;\n                font-style: italic;\n            }\n\n            .loading-state {\n                color: var(--widget-text-muted, #666);\n            }\n\n            .error-state {\n                color: var(--widget-danger, #dc3545);\n                background: rgba(220, 53, 69, 0.1);\n                border: 1px solid var(--widget-danger, #dc3545);\n                border-radius: var(--widget-border-radius, 4px);\n            }\n\n            .empty-state {\n                color: var(--widget-text-muted, #666);\n            }\n\n            .spinner {\n                border: 3px solid var(--widget-light, #f3f3f3);\n                border-top: 3px solid var(--widget-primary, #007cba);\n                border-radius: 50%;\n                width: 30px;\n                height: 30px;\n                animation: spin 1s linear infinite;\n                margin: 0 auto 1rem;\n            }\n\n            @keyframes spin {\n                0% { transform: rotate(0deg); }\n                100% { transform: rotate(360deg); }\n            }\n\n            @media (max-width: 768px) {\n                .comment-widget {\n                    margin: 1rem;\n                    padding: 1rem;\n                }\n\n                .comment-item.level-1,\n                .comment-item.level-2 {\n                    margin-left: 1rem;\n                }\n\n                .theme-selector {\n                    margin-top: 0.5rem;\n                    width: 100%;\n                }\n\n                .comment-header {\n                    flex-direction: column;\n                    align-items: stretch;\n                }\n            }\n        "}getDarkTheme(){return"\n            .comment-widget {\n                background: #2d2d2d;\n                border-color: #444;\n                color: #e0e0e0;\n                box-shadow: 0 2px 10px rgba(0,0,0,0.3);\n            }\n\n            .comment-header h3 {\n                color: #e0e0e0;\n            }\n\n            .theme-selector {\n                background: #3a3a3a;\n                border-color: #555;\n                color: #e0e0e0;\n            }\n\n            .comment-form {\n                background: #3a3a3a;\n                border-color: #555;\n            }\n\n            .form-group input,\n            .form-group textarea {\n                background: #3a3a3a;\n                border-color: #555;\n                color: #e0e0e0;\n            }\n\n            .submit-btn {\n                background: #4fc3f7;\n                color: #000;\n            }\n\n            .submit-btn:hover {\n                background: #29b6f6;\n            }\n\n            .comment-item {\n                background: #2d2d2d;\n                border-color: #444;\n                color: #e0e0e0;\n                border-left-color: #4fc3f7;\n            }\n\n            .comment-item.level-1 {\n                border-left-color: #888;\n            }\n\n            .comment-item.level-2 {\n                border-left-color: #ccc;\n            }\n\n            .avatar-placeholder {\n                background: #4fc3f7;\n                color: #000;\n            }\n\n            .comment-author {\n                color: #4fc3f7;\n            }\n\n            .comment-date {\n                color: #b0b0b0;\n            }\n\n            .comment-text {\n                color: #e0e0e0;\n            }\n\n            .reply-btn {\n                color: #4fc3f7;\n            }\n\n            .reply-btn:hover {\n                color: #29b6f6;\n            }\n\n            .loading-state,\n            .empty-state {\n                color: #b0b0b0;\n            }\n\n            .error-state {\n                color: #ff6b6b;\n                background: rgba(255, 107, 107, 0.1);\n                border-color: rgba(255, 107, 107, 0.3);\n            }\n        "}getMatrixTheme(){return"\n            .comment-widget {\n                background: #000;\n                border-color: #0a0;\n                color: #0f0;\n                font-family: 'Courier New', monospace;\n                box-shadow: 0 2px 10px rgba(0,255,0,0.1);\n            }\n\n            .comment-header h3 {\n                color: #0f0;\n            }\n\n            .theme-selector {\n                background: #010;\n                border-color: #080;\n                color: #0f0;\n                font-family: 'Courier New', monospace;\n            }\n\n            .comment-form {\n                background: #010;\n                border-color: #080;\n            }\n\n            .form-group input,\n            .form-group textarea {\n                background: #010;\n                border-color: #080;\n                color: #0f0;\n                font-family: 'Courier New', monospace;\n            }\n\n            .submit-btn {\n                background: #0a0;\n                color: #000;\n                font-family: 'Courier New', monospace;\n            }\n\n            .submit-btn:hover {\n                background: #0f0;\n                box-shadow: 0 0 5px rgba(0, 255, 0, 0.5);\n            }\n\n            .comment-item {\n                background: #000;\n                border-color: #0a0;\n                color: #0f0;\n                border-left-color: #0f0;\n                font-family: 'Courier New', monospace;\n            }\n\n            .comment-item.level-1 {\n                border-left-color: #080;\n            }\n\n            .comment-item.level-2 {\n                border-left-color: #040;\n            }\n\n            .avatar-placeholder {\n                background: #0f0;\n                color: #000;\n            }\n\n            .comment-author {\n                color: #0f0;\n            }\n\n            .comment-date {\n                color: #6b7280;\n            }\n\n            .comment-text {\n                color: #0f0;\n            }\n\n            .reply-btn {\n                color: #0f0;\n            }\n\n            .reply-btn:hover {\n                color: #0a0;\n                text-shadow: 0 0 3px rgba(0, 255, 0, 0.5);\n            }\n\n            .loading-state,\n            .empty-state {\n                color: #6b7280;\n            }\n\n            .error-state {\n                color: #ff4444;\n                background: rgba(255, 68, 68, 0.1);\n                border-color: rgba(255, 68, 68, 0.3);\n            }\n        "}getNeocitiesTheme(){return"\n            .comment-widget {\n                background: #ccffff;\n                border: 2px dashed #996699;\n                color: #330033;\n                box-shadow: 0 4px 15px rgba(153, 102, 153, 0.2);\n            }\n\n            .comment-header h3 {\n                color: #330033;\n            }\n\n            .theme-selector {\n                background: #ffff99;\n                border: 2px dotted #669966;\n                color: #330033;\n            }\n\n            .comment-form {\n                background: #ffff99;\n                border: 2px dotted #669966;\n            }\n\n            .form-group input,\n            .form-group textarea {\n                background: #ffff99;\n                border: 2px dotted #669966;\n                color: #330033;\n            }\n\n            .submit-btn {\n                background: #ffccff;\n                color: #330033;\n                border: 2px solid #996699;\n            }\n\n            .submit-btn:hover {\n                background: #ff99ff;\n            }\n\n            .comment-item {\n                background: #ccffff;\n                border: 2px dashed #996699;\n                color: #330033;\n                border-left: 4px solid #996699;\n            }\n\n            .comment-item.level-1 {\n                border-left-color: #669966;\n                border-left-style: dotted;\n            }\n\n            .comment-item.level-2 {\n                border-left-color: #cc99ff;\n                border-left-style: dashed;\n            }\n\n            .avatar-placeholder {\n                background: #ffccff;\n                color: #330033;\n                border: 2px solid #996699;\n            }\n\n            .comment-author {\n                color: #663399;\n                font-weight: bold;\n            }\n\n            .comment-date {\n                color: #666699;\n            }\n\n            .comment-text {\n                color: #330033;\n            }\n\n            .reply-btn {\n                color: #663399;\n                background: #ffccff;\n                border: 1px solid #996699;\n                padding: 0.2rem 0.5rem;\n                border-radius: 3px;\n            }\n\n            .reply-btn:hover {\n                background: #ff99ff;\n            }\n\n            .loading-state,\n            .empty-state {\n                color: #666699;\n            }\n\n            .error-state {\n                color: #cc0000;\n                background: rgba(255, 204, 204, 0.7);\n                border: 2px dashed #cc6666;\n            }\n        "}getSereneMistTheme(){return{colors:{primary:"#8B9D77",secondary:"#A8B5A0",background:"#F8F9F7",surface:"#FFFFFF",text:"#4A5D3A","text-muted":"#7A8F69",border:"#D4E2D0",light:"#F0F2EF",danger:"#C17D5F"},fonts:{family:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",size:"14px",weight:"400"},spacing:{small:"8px",medium:"16px",large:"24px"},borderRadius:"12px",transitions:{duration:"0.4s",easing:"cubic-bezier(0.4, 0, 0.2, 1)"}}}getNeonPulseTheme(){return{colors:{primary:"#00FF88",secondary:"#FF0080",background:"#0A0A0A",surface:"#1A1A1A",text:"#FFFFFF","text-muted":"#888888",border:"#333333",light:"#2A2A2A",danger:"#FF4444"},fonts:{family:"'JetBrains Mono', 'Courier New', monospace",size:"14px",weight:"400"},spacing:{small:"8px",medium:"16px",large:"24px"},borderRadius:"4px",transitions:{duration:"0.2s",easing:"ease-out"}}}getGeometricPrimeTheme(){return{colors:{primary:"#FF6B35",secondary:"#F7931E",background:"#2C2C2C",surface:"#3A3A3A",text:"#FFFFFF","text-muted":"#CCCCCC",border:"#555555",light:"#4A4A4A",danger:"#FF4444"},fonts:{family:"'IBM Plex Sans', sans-serif",size:"14px",weight:"500"},spacing:{small:"12px",medium:"20px",large:"32px"},borderRadius:"0px",transitions:{duration:"0.3s",easing:"ease-in-out"}}}getForestFlowTheme(){return{colors:{primary:"#2D5A3D",secondary:"#4A7C59",background:"#F5F8F5",surface:"#FFFFFF",text:"#1A3D2A","text-muted":"#5A8F6B",border:"#B8D4BB",light:"#E8F5E8",danger:"#8B4513"},fonts:{family:"'Crimson Text', serif",size:"15px",weight:"400"},spacing:{small:"10px",medium:"18px",large:"28px"},borderRadius:"16px",transitions:{duration:"0.5s",easing:"ease-in-out"}}}getDigitalChaosTheme(){return{colors:{primary:"#FF00FF",secondary:"#00FFFF",background:"#000000",surface:"#0F0F0F",text:"#FFFFFF","text-muted":"#AAAAAA",border:"#333333",light:"#1A1A1A",danger:"#FF0000"},fonts:{family:"'Share Tech Mono', monospace",size:"13px",weight:"400"},spacing:{small:"6px",medium:"12px",large:"18px"},borderRadius:"2px",transitions:{duration:"0.1s",easing:"step-end"}}}}class r{static generateThreadId(){return btoa(window.location.href).replace(/[^a-zA-Z0-9]/g,"").substring(0,16)}static generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}static debounce(e,t){let n;return function(...r){clearTimeout(n),n=setTimeout(()=>{clearTimeout(n),e(...r)},t)}}static throttle(e,t){let n;return function(){const r=arguments,o=this;n||(e.apply(o,r),n=!0,setTimeout(()=>n=!1,t))}}static escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}static formatDate(e){if(!e)return"";const t=new Date(e),n=new Date,r=Math.floor((n-t)/1e3),o=Math.floor(r/60),a=Math.floor(o/60),i=Math.floor(a/24);return r<60?"Just now":o<60?`${o}m ago`:a<24?`${a}h ago`:i<7?`${i}d ago`:t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}static formatContent(e){return this.escapeHtml(e).replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`(.*?)`/g,"<code>$1</code>").replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>')}static validateEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}static validateComment(e){const t=[];return(!e.author_name||e.author_name.trim().length<2)&&t.push("Name must be at least 2 characters long"),e.author_email&&this.validateEmail(e.author_email)||t.push("Please enter a valid email address"),(!e.content||e.content.trim().length<10)&&t.push("Comment must be at least 10 characters long"),e.content&&e.content.length>2e3&&t.push("Comment must be less than 2000 characters"),{isValid:0===t.length,errors:t}}static showNotification(e,t="info",n=3e3){const r=document.createElement("div");r.className=`notification notification-${t}`,r.textContent=e,Object.assign(r.style,{position:"fixed",top:"20px",right:"20px",padding:"12px 16px",borderRadius:"4px",color:"white",fontSize:"14px",zIndex:"10000",opacity:"0",transform:"translateY(-20px)",transition:"all 0.3s ease",maxWidth:"300px",wordWrap:"break-word"});const o={success:"#28a745",error:"#dc3545",warning:"#ffc107",info:"#007bff"};r.style.backgroundColor=o[t]||o.info,document.body.appendChild(r),setTimeout(()=>{r.style.opacity="1",r.style.transform="translateY(0)"},10),setTimeout(()=>{r.style.opacity="0",r.style.transform="translateY(-20px)",setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r)},300)},n)}static copyToClipboard(e){if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(e);{const t=document.createElement("textarea");return t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select(),new Promise((e,n)=>{document.execCommand("copy")?e():n(new Error("Failed to copy text")),document.body.removeChild(t)})}}static getViewportSize(){return{width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}}static isMobile(){return this.getViewportSize().width<768}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static scrollToElement(e,t=0){if(!e)return;const n=e.getBoundingClientRect().top+window.pageYOffset-t;window.scrollTo({top:n,behavior:"smooth"})}static animateElement(e,t,n=300){return e?new Promise(r=>{e.style.animation=`${t} ${n}ms ease`,setTimeout(()=>{e.style.animation="",r()},n)}):Promise.resolve()}static deepClone(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof Array)return e.map(e=>this.deepClone(e));if("object"==typeof e){const t={};return Object.keys(e).forEach(n=>{t[n]=this.deepClone(e[n])}),t}}static sleep(e){return new Promise(t=>setTimeout(t,e))}}class o extends HTMLElement{constructor(){super(),this.threadId=this.getAttribute("thread-id")||r.generateThreadId(),this.apiBaseUrl=this.getAttribute("api-base-url")||"https://comment-widget-backend.vercel.app",this.theme=this.getAttribute("theme")||"default",this.maxDepth=parseInt(this.getAttribute("max-depth"))||3,this.api=new e(this.apiBaseUrl),this.renderer=new t,this.themeManager=new n(this.theme),this.comments=[],this.loading=!1,this.error=null,this.shadow=this.attachShadow({mode:"open"}),this.init()}async init(){try{this.loading=!0,this.render(),await this.loadComments(),this.loading=!1,this.render()}catch(e){console.error("Widget initialization error:",e),this.error=e.message,this.loading=!1,this.render()}}async loadComments(){try{const e=await this.api.getComments(this.threadId);this.comments=e.comments||[]}catch(e){console.error("Error loading comments:",e),this.error="Failed to load comments"}}async submitComment(e){try{this.loading=!0,this.render();const t=await this.api.createComment({thread_id:parseInt(this.threadId),author_name:e.author_name,author_email:e.author_email,content:e.content,parent_id:e.parent_id||null});return await this.loadComments(),this.loading=!1,this.render(),t}catch(e){throw console.error("Error submitting comment:",e),this.error=e.message,this.loading=!1,this.render(),e}}setTheme(e){this.theme=e,this.themeManager.setTheme(e),this.render()}connectedCallback(){document.addEventListener("themeChange",e=>{e.detail&&e.detail.theme&&(this.setAttribute("theme",e.detail.theme),this.setTheme(e.detail.theme))})}render(){this.loadEnhancedCSS();const e=this.themeManager.getStyles(),t=this.renderer.render({comments:this.comments,loading:this.loading,error:this.error,theme:this.theme,maxDepth:this.maxDepth,onSubmit:e=>this.submitComment(e),onThemeChange:e=>this.setTheme(e)});this.shadow.innerHTML=`\n            <style>${e}</style>\n            ${t}\n        `}loadEnhancedCSS(){if(!this.shadow.querySelector("#widget-enhanced-css")){const e=document.createElement("link");e.id="widget-enhanced-css",e.rel="stylesheet",e.href="/widget/src/widget.css",this.shadow.appendChild(e)}}refresh(){this.loadComments()}getComments(){return this.comments}getTheme(){return this.theme}}customElements.define("comment-widget",o),document.addEventListener("DOMContentLoaded",()=>{console.log("Comment Widget v2.0 loaded")}),"undefined"!=typeof module&&module.exports&&(module.exports={CommentWidget:o})});
//# sourceMappingURL=comment-widget.umd.min.js.map
